<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Importador de Extrato Bancário</title>
  <link rel="stylesheet" href="estilo/style.css" />
</head>
<body>
  <h1>📊 Importador de tabelas</h1>

  <!-- 🔄 Campos lado a lado -->
  <div class="input-row">
    <label for="banco">Banco:</label>
    <input type="text" id="banco" placeholder="Digite o nome do banco" />

    <label for="movimento">Movimentação:</label>
    <input type="text" id="movimento" placeholder="Digite o tipo de movimentação" />

    <button onclick="renderTable()" style="margin-left: 10px;">🔄 Atualizar Tabela</button>
  </div>

  <!-- 📂 Upload de arquivo -->
  <input type="file" id="file-input" accept=".txt,.xlsx" />

  <button onclick="salvarNovo()" style="display: none;">💾 Salvar como Novo</button>
  <!--
  <button id="desfazer-btn">🔄 Desfazer exclusões</button>
  <button onclick="desfazerEdicao()">🔄 Desfazer edição</button>
  -->

  <!-- ✏️ Tabela de edição -->
  <h2 id="h2-tabela-edicao">✏️ Edição de Lançamento</h2>
  <table id="tabela-edicao" style="display: none;">
    <thead>
      <tr>
        <th>Data</th>
        <th>Débito</th>
        <th>Crédito</th>
        <th>Histórico</th>
        <th>Valor</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- 🔢 Totais -->
    <div id="totais-edicao">
        <p><span id="total-debito">Débito: </span></p>
        <p><span id="total-credito">Crédito: </span></p>
        <p><span id="diferenca">Diferença: </span></p>
    </div>

  <!-- 💾 Botão de salvar alterações -->
    <button id="salvar-edicao-btn" style="display: none;">💾 Salvar Alterações</button>

  <!-- 📋 Tabela principal -->
  <h2>📋 Lançamentos</h2>
  <table id="tabela">
    <thead>
      <tr>
        <th>Data</th>
        <th>Débito</th>
        <th>Crédito</th>
        <th>Histórico</th>
        <th>Valor</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- 💾 Botão para salvar como TXT -->
  <button onclick="gerarArquivoTxt()" style="margin-top: 20px; padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 5px;">
    💾 Salvar como TXT
  </button>

  <script src="xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>